{
  "name": "flink-sql-workbench",
  "displayName": "Flink SQL Workbench",
  "description": "VS Code extension for editing and executing Flink SQL with gateway session management (Avichay Marciano, Iulius Hutuleac)",
  "version": "0.1.5",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/giulio1979/flink-sql-workbench-vsce.git"
  },
  "categories": [
    "Data Science",
    "Other"
  ],
  "engines": {
    "vscode": "^1.103.0",
    "code-server": "^4.0.0"
  },
  "extensionDependencies": [
    "IuliusHutuleac.credential-manager"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./dist/extension.js",
  "publisher": "IuliusHutuleac",
  "contributes": {
    "languages": [
      {
        "id": "flinksql",
        "aliases": [
          "Flink SQL",
          "flinksql"
        ],
        "extensions": [
          ".flink.sql"
        ],
        "configuration": "./language-configuration.json"
      }
    ],
    "customEditors": [
      {
        "viewType": "flink-sql-workbench.sqlEditor",
        "displayName": "Flink SQL Editor",
        "selector": [
          {
            "filenamePattern": "*.flink.sql"
          }
        ],
        "priority": "option"
      }
    ],
    "commands": [
      {
        "command": "flink-sql-workbench.executeQuery",
        "title": "Execute Flink SQL Query",
        "icon": "$(play)"
      },
      {
        "command": "flink-sql-workbench.executeAllQueries",
        "title": "Execute All Queries",
        "icon": "$(play-circle)"
      },
      {
        "command": "flink-sql-workbench.stopQuery",
        "title": "Stop Current Query",
        "icon": "$(stop)"
      },
      {
        "command": "flink-sql-workbench.connectToGateway",
        "title": "Connect to Flink Gateway"
      },
      {
        "command": "flink-sql-workbench.disconnectFromGateway",
        "title": "Disconnect from Flink Gateway"
      },
      {
        "command": "flink-sql-workbench.showResults",
        "title": "Show Query Results"
      },
      {
        "command": "flink-sql-workbench.testResults",
        "title": "Test Results Panel"
      },
      {
        "command": "flink-sql-workbench.testEmptyResults",
        "title": "Test Empty Results Panel"
      },
      {
        "command": "flink-sql-workbench.refreshSessions",
        "title": "Refresh Session",
        "icon": "$(refresh)"
      },
      {
        "command": "flink-sql-workbench.createSession",
        "title": "Create New Session",
        "icon": "$(add)"
      },
      {
        "command": "flink-sql-workbench.deleteSession",
        "title": "Delete Current Session",
        "icon": "$(trash)"
      },
      {
        "command": "flink-sql-workbench.viewSessionInfo",
        "title": "View Session Info"
      },
      {
        "command": "flink-sql-workbench.setActiveSession",
        "title": "Set as Active Session",
        "icon": "$(star-full)"
      },
      {
        "command": "flink-sql-workbench.showOutput",
        "title": "Show Flink SQL Output",
        "icon": "$(output)"
      },
      {
        "command": "flink-sql-workbench.refreshCatalog",
        "title": "Refresh Catalog",
        "icon": "$(refresh)"
      },
      {
        "command": "flink-sql-workbench.setCatalog",
        "title": "Set as Current Catalog"
      },
      {
        "command": "flink-sql-workbench.insertTableReference",
        "title": "Insert Reference"
      },
      {
        "command": "flink-sql-workbench.refreshJobs",
        "title": "Refresh Jobs",
        "icon": "$(refresh)"
      },
      {
        "command": "flink-sql-workbench.toggleJobsAutoRefresh",
        "title": "Toggle Auto Refresh",
        "icon": "$(sync)"
      },
      {
        "command": "flink-sql-workbench.stopJob",
        "title": "Stop Job",
        "icon": "$(debug-stop)"
      },
      {
        "command": "flink-sql-workbench.cancelJob",
        "title": "Cancel Job",
        "icon": "$(close)"
      },
      {
        "command": "flink-sql-workbench.viewJobDetails",
        "title": "View Job Details",
        "icon": "$(info)"
      },
      {
        "command": "flink-sql-workbench.openSettings",
        "title": "Open Flink SQL Workbench Settings",
        "icon": "$(gear)"
      },
      {
        "command": "flink-sql-workbench.selectConnection",
        "title": "Select Credential Manager Connection",
        "icon": "$(database)"
      },
      {
        "command": "flink-sql-workbench.refreshConnections",
        "title": "Refresh Available Connections",
        "icon": "$(refresh)"
      },
      {
        "command": "flink-sql-workbench.clearConnection",
        "title": "Clear Current Connection",
        "icon": "$(close)"
      },
      {
        "command": "flink-sql-workbench.openCredentialManager",
        "title": "Open Credential Manager",
        "icon": "$(settings-gear)"
      }
    ],
    "views": {
      "explorer": [
        {
          "id": "flinkSqlConnections",
          "name": "Flink Gateway Connections",
          "icon": "$(database)"
        },
        {
          "id": "flinkSqlSessions",
          "name": "Flink SQL Session",
          "icon": "$(server)"
        },
        {
          "id": "flinkSqlCatalog",
          "name": "Flink SQL Catalog",
          "icon": "$(database)"
        },
        {
          "id": "flinkSqlJobs",
          "name": "Flink SQL Jobs",
          "icon": "$(play)"
        }
      ]
    },
    "viewsWelcome": [
      {
        "view": "flinkSqlConnections",
        "contents": "No Flink Gateway connections found.\n[Select Connection](command:flink-sql-workbench.selectConnection)\n[Open Credential Manager](command:flink-sql-workbench.openCredentialManager)\n[Refresh Connections](command:flink-sql-workbench.refreshConnections)\nTo learn more about setting up connections [read our docs](https://github.com/giulio1979/flink-sql-workbench-vsce#credential-manager-setup)."
      },
      {
        "view": "flinkSqlSessions",
        "contents": "No Flink SQL Gateway connection.\n[Connect to Gateway](command:flink-sql-workbench.connectToGateway)\nTo learn more about Flink SQL Gateway [read our docs](https://nightlies.apache.org/flink/flink-docs-release-1.17/docs/dev/table/sql-gateway/overview/).",
        "when": "!flinkGatewayConnected"
      },
      {
        "view": "flinkSqlSessions",
        "contents": "Connected to Gateway but no active session.\n[Create Session](command:flink-sql-workbench.createSession)",
        "when": "flinkGatewayConnected && !hasActiveSession"
      },
      {
        "view": "flinkSqlCatalog",
        "contents": "No Flink SQL Gateway connection.\n[Connect to Gateway](command:flink-sql-workbench.connectToGateway)",
        "when": "!flinkGatewayConnected"
      },
      {
        "view": "flinkSqlJobs",
        "contents": "No Flink SQL Gateway connection.\n[Connect to Gateway](command:flink-sql-workbench.connectToGateway)",
        "when": "!flinkGatewayConnected"
      }
    ],
    "menus": {
      "editor/title": [
        {
          "command": "flink-sql-workbench.executeQuery",
          "when": "resourceLangId == flinksql",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.executeAllQueries",
          "when": "resourceLangId == flinksql",
          "group": "navigation"
        }
      ],
      "commandPalette": [
        {
          "command": "flink-sql-workbench.executeQuery",
          "when": "resourceLangId == flinksql"
        },
        {
          "command": "flink-sql-workbench.executeAllQueries",
          "when": "resourceLangId == flinksql"
        },
        {
          "command": "flink-sql-workbench.stopQuery",
          "when": "resourceLangId == flinksql"
        },
        {
          "command": "flink-sql-workbench.showResults"
        },
        {
          "command": "flink-sql-workbench.testResults"
        },
        {
          "command": "flink-sql-workbench.testEmptyResults"
        },
        {
          "command": "flink-sql-workbench.selectConnection"
        },
        {
          "command": "flink-sql-workbench.refreshConnections"
        },
        {
          "command": "flink-sql-workbench.clearConnection"
        },
        {
          "command": "flink-sql-workbench.openCredentialManager"
        }
      ],
      "view/title": [
        {
          "command": "flink-sql-workbench.selectConnection",
          "when": "view == flinkSqlConnections",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.refreshConnections",
          "when": "view == flinkSqlConnections",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.openCredentialManager",
          "when": "view == flinkSqlConnections",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.refreshSessions",
          "when": "view == flinkSqlSessions",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.createSession",
          "when": "view == flinkSqlSessions && flinkGatewayConnected",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.refreshCatalog",
          "when": "view == flinkSqlCatalog",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.refreshJobs",
          "when": "view == flinkSqlJobs",
          "group": "navigation"
        },
        {
          "command": "flink-sql-workbench.toggleJobsAutoRefresh",
          "when": "view == flinkSqlJobs",
          "group": "navigation"
        }
      ],
      "view/item/context": [
        {
          "command": "flink-sql-workbench.setActiveSession",
          "when": "view == flinkSqlSessions && viewItem == session",
          "group": "inline@1"
        },
        {
          "command": "flink-sql-workbench.viewSessionInfo",
          "when": "view == flinkSqlSessions && viewItem == session",
          "group": "inline@2"
        },
        {
          "command": "flink-sql-workbench.deleteSession",
          "when": "view == flinkSqlSessions && viewItem == session",
          "group": "inline@3"
        },
        {
          "command": "flink-sql-workbench.setCatalog",
          "when": "view == flinkSqlCatalog && viewItem == catalog"
        },
        {
          "command": "flink-sql-workbench.insertTableReference",
          "when": "view == flinkSqlCatalog && (viewItem == catalog || viewItem == database || viewItem == table)"
        },
        {
          "command": "flink-sql-workbench.stopJob",
          "when": "view == flinkSqlJobs && viewItem == runningJob",
          "group": "jobActions@1"
        },
        {
          "command": "flink-sql-workbench.stopJob",
          "when": "view == flinkSqlJobs && viewItem == runningJob",
          "group": "inline@1"
        },
        {
          "command": "flink-sql-workbench.cancelJob",
          "when": "view == flinkSqlJobs && viewItem == runningJob",
          "group": "jobActions@2"
        },
        {
          "command": "flink-sql-workbench.viewJobDetails",
          "when": "view == flinkSqlJobs && (viewItem == runningJob || viewItem == finishedJob || viewItem == cancelledJob || viewItem == failedJob)",
          "group": "jobInfo@1"
        }
      ]
    },
    "keybindings": [
      {
        "command": "flink-sql-workbench.executeQuery",
        "key": "ctrl+enter",
        "mac": "cmd+enter",
        "when": "resourceLangId == flinksql"
      },
      {
        "command": "flink-sql-workbench.executeAllQueries",
        "key": "ctrl+shift+enter",
        "mac": "cmd+shift+enter",
        "when": "resourceLangId == flinksql"
      }
    ],
    "configuration": {
      "title": "Flink SQL Workbench",
      "properties": {
        "flinkSqlWorkbench.gateway.connectionId": {
          "type": "string",
          "default": "",
          "description": "Connection ID from credential manager for Flink Gateway access"
        },
        "flinkSqlWorkbench.gateway.useProxy": {
          "type": "boolean",
          "default": false,
          "description": "Use proxy for requests to avoid CORS issues"
        },
        "flinkSqlWorkbench.session.properties": {
          "type": "object",
          "default": {
            "execution.runtime-mode": "streaming",
            "table.exec.resource.default-parallelism": "1",
            "execution.checkpointing.interval": "10s"
          },
          "description": "Default session properties for Flink SQL Gateway sessions",
          "additionalProperties": {
            "type": "string"
          }
        },
        "flinkSqlWorkbench.logging.level": {
          "type": "string",
          "enum": [
            "trace",
            "debug",
            "info",
            "warn",
            "error"
          ],
          "default": "info",
          "description": "Logging level for the extension"
        },
        "flinkSqlWorkbench.jobs.autoRefresh": {
          "type": "boolean",
          "default": false,
          "description": "Automatically refresh jobs list"
        },
        "flinkSqlWorkbench.jobs.refreshInterval": {
          "type": "number",
          "default": 10000,
          "description": "Jobs auto-refresh interval in milliseconds"
        }
      }
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run package",
    "compile": "webpack",
    "watch": "webpack --watch",
    "package": "webpack --mode production --devtool hidden-source-map",
    "compile-tests": "tsc -p . --outDir out",
    "watch-tests": "tsc -p . -w --outDir out",
    "pretest": "npm run compile-tests && npm run compile && npm run lint",
    "lint": "eslint src",
    "test": "vscode-test"
  },
  "devDependencies": {
    "@types/mocha": "^10.0.10",
    "@types/nock": "^10.0.3",
    "@types/node": "22.x",
    "@types/sinon": "^17.0.4",
    "@types/vscode": "^1.103.0",
    "@typescript-eslint/eslint-plugin": "^8.39.0",
    "@typescript-eslint/parser": "^8.39.0",
    "@vscode/test-cli": "^0.0.11",
    "@vscode/test-electron": "^2.5.2",
    "axios": "^1.12.2",
    "eslint": "^9.32.0",
    "nock": "^14.0.10",
    "sinon": "^21.0.0",
    "ts-loader": "^9.5.2",
    "typescript": "^5.9.2",
    "webpack": "^5.101.0",
    "webpack-cli": "^6.0.1"
  }
}
